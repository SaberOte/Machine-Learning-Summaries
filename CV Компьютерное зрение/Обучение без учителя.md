## Autoencoders  
Базовый автоэнкодер представлен на рисунке. Состоит из трех частей. Энкодер, по центру эмбеддинг и далее декодер. Больше и нечего добавить. Разве что смешная функция потерь, которая тоже представлена на рисунке. По сути это L2 расстояние между N-мерными пространствами, где N - количество пикселей на картинке.  
![Pasted image 20230608005356.png](https://github.com/PolkaDott/Data-Science-Summaries/blob/main/CV%20Компьютерное%20зрение/attachments/Pasted%20image%2020230608005356.png?raw=true)  
  
### VAE (Variational Autoencoder)  
Проблема базового автоэнкодера в том, что модель очень легко переобучается. То есть при малейшем отдалении от точки в пространстве векторов модель выдаёт неадекватные данные, поэтому в вариационном автоэнкодере эмбеддинг усложняется, чтобы он не был ориентирован на идее "точки в многомерном пространстве", а был ориентирован на некоторой евклидовой **сфере** (облачке) вокруг этой точки для тренировки более универсального декодера.  
  
![Pasted image 20230608010526.png](https://github.com/PolkaDott/Data-Science-Summaries/blob/main/CV%20Компьютерное%20зрение/attachments/Pasted%20image%2020230608010526.png?raw=true)  
Как видно на картинке, вместо эмбеддинга теперь 2 значения - $\mu$ и $\sigma$ (мю и сигма). Мю - это тот же вектор в пространстве. Среднее в этой сфере.  
Сигма - это расстояние, ограничивающее размер сферы в пространстве.  
  
Эти 2 значения передаются дальше, но складываются хитрым способом.   
n здесь - случайное число (фиксированное для одного примера) от 0 до 1 (которое ещё и нормально распределено вокруг нуля). Нужно оно для того, чтобы отдавать на декодер случайную точку в пределах сферы.   
  
Такая хитрость добавляет шума и заставляет декодер реконструировать картинку исходя из искаженных данных.  
  
Функция потерь будет состоять из двух частей.   
Первая - стандартная, которая оценивает точность репликации объекта. Представлена в начале.  
Вторая отвечает за то, чтобы сигма в центральном слое стремилась быть максимальной.  
Обе эти функции складываются.  
  
Таким образом, две функции потерь, задачи которых почти противоположны, заставляют сеть балансировать между разрастанием сферы и точностью генерации.  
  
##### Интерполяции  
Натренированная модель на вариационном автоэнкодере универсальна и может даже рисовать не существовавшие ранее картинки, если брать точки по другим координатам в пространстве. Можно кластеризовать данные, образуя облачка с некоторыми параметрами, чтобы, перемещая точку из одного в другое, прицельно изменять эти параметры.  
![Pasted image 20230608012641.png](https://github.com/PolkaDott/Data-Science-Summaries/blob/main/CV%20Компьютерное%20зрение/attachments/Pasted%20image%2020230608012641.png?raw=true)