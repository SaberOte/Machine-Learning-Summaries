Для оценки случайности отличий номинативных данных можно использовать критерий Хи-квадрат Пирсона. Для ряда из последовательных наблюдений используется формула  
$$\chi^2=\sum^n_{i=1}\frac{(O_i-E_i)^2}{E_i}$$, где $O_i$ - это реальное значение из ряда наблюдений, $E_i$ - ожидаемое значение, при котором будет идеальное соответствие нулевой гипотезе о равности наблюдений.  
Полученное значение можно оценить с помощью калькулятора, например с [этого](https://gallery.shinyapps.io/dist_calc/) сайта, выбрав метод Хи квадрата и подставив число степеней свободы  
  
Пример задачи:  
  
Реальные наблюдения | 5 | 10 | 15  
-| - | - | -   
Ожидаемые значения | 10 | 10 | 10  
Значение критерия будет:  
$$\chi^2=\frac{(5-10)^2}{10}+\frac{(10-10)^2}{10}+\frac{(15-10)^2}{10}=5$$  
Хи-квадрат равен 5, степеней свободы 2, значит p-value равен 0.082, поэтому можно отвергнуть нулевую гипотезу о равности ожидаемых значений и реальных наблюдений.  
  
Конечно же, можно не только равные значения брать, но и некоторые пропорции. Например, если необходимо узнать, правда ли наблюдения распределены в соотношениях 1:2:2. Тогда ожидаемые значения в прошлой задаче будут не 10, 10, 10, а 6, 12, 12.   
  
### Таблица сопряженности   
Формула для расчёта ожидаемых частот в таблице сопряженности:  
$$f_{i,j}=\frac{f_i\cdot f_j}{N}$$  
, где $f_i$ - сумма значений в столбце, $f_j$ - сумма значений в строке (или наоборот), $N$ - сумма всех значений  
Этими частотами и заполняется таблица. Далее, имея 2 таблицы нужно каждую ячейку подставить в формулу Хи-квадрата.   
Используется для представления совместного распределения двух переменных.  
  
Пример решения задачи на скриншоте  
![[Pasted image 20221205011240.png|500]]  
  
Обязательно наблюдения должны быть независимыми, число наблюдений должно быть не меньше 5! Если всё таки выборка имеет меньше, то нужно использовать **точный критерий Фишера**  
  
### Поправка Йетса  
Если наблюдений мало, некоторые значения меньше 10, то может использоваться *поправка Йетса*. Формула расчёта частоты сопряжённости с этой поправкой:  
$$\chi^2_{Yates}=\sum^n_{i=1}\frac{(|O_i-E_i|-0.5)^2}{E_i}$$